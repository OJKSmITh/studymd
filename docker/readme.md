# 1. Docker란?
컨테이너 기반의 오픈소스 가상화 플랫폼

어떤 프로그램을 외부 환경과 격리시켜 구동할 수 있게 해주는 소프트웨어

OS환경에 크게 영향을 받지 않게끔 한다고 생각하면 됨

## Container란
OS 상에 논리적인 영역(컨테이너)을  구축하고, app이 작동하는데 필요한 요소들을 모아 별도의 서버처럼 동작하는 것 
infrastructure: lam, cpu 등
Host Operation System: 운영체제
Docker
App들 
<img src="../img폴더/docker/Docker%20whole%20image.png"/>

Docker라는 계층을 만들어서, app 들을 올리는 기술들을 Docker 라고 함

어디에 겹쳐진게 아니라, container처럼 표현하게 됨, 격리되어 있는 환경들이라고 말을 많이 함, 


a,b 환경이 아예 달라도 영향을 주지 않는다는 것, window 프로그램 설치를 많이 쓸텐데, 이런 소프트 웨어 사용시

시스템 요구사항을 보고 설치하게 되는데, lam, hard등 시스템 요구사항을 보고 설치하게 되는데, 이런것들이 사실 굉장히 까다롭다.

docker는 기본적으로 linux 기반으로 동작해서 Linux 기반으로 사용한다는 것이라고 생각하면 될듯

linux app을 사용한다고 생각하면 편할듯, 

장점으로는 필요한 요소만으로 구성되어 있어 오버헤드가 적다는 것이 장점이다. docker 가 나왔을때 vm과 비교가 많이 됐는데 vm을 각각 이미지를 설치해서 사용했었는데

운영체제를 설치한다는 의미이고, 운영체제의 중요 기술을 일부분 가져와서 os로 보이게끔 세팅해서 보여준다고 생각하면 된다.

쓸때 없는 기능들을 줄였다는 것이 장점이라는 것


## Docker 기초 강의
Docker 사용에 초점을 맞춰 진행할 예정

가상화 기술과 같이 설명이 어려운 부분은 최대한 이해하기 쉽게 풀어 설명할 예정, 이 과정에서 구체적인 기술들을 설명하는 것은 생략될 수 있음

구체적이고 어려운 내용들은 이후 과정에서 다룰 예정

간혹 사용 소프트웨어가 아닌 직접 개발한 app을 가동해보는 시간을 가질 수도 있음, 이때는 스프링 부트 강의에서 사용하고 있는 프로젝트를 사용할 예정

# 2. 도커 컨테이너 구조 및 커맨드 사용법
도커 컨테이너는 컨테이너 레이어와, 이미지 레이어로 구성되어 있음 

컨테이너를 만들기 위해서는 이미지라는 것이 필요한데 이미지는, 도커 허브, 여러가지 레포지토리에서 가져올 수 있는 형태를 말함, 

이미지 레이어라는 몇가지 층으로 되어 있는데  읽기 전용의 계층이다로 보면 될거같다.

이미지를 컨테이너에 올리게 되면, 하나의 계층이 추가되고, 이를 컨테이너 레이어라고 부르며, 빌드와 쓰기가 가능해짐 사용하면서 추가되는 변경 사항은

컨테이너 레이어에 추가가된다는 것이다. 

다시 정리하자면 컨테이너 레이어는 읽기/쓰기가 모두 가능한 계층으로 최상단 레이어에 추가된다. 또한 이후 컨테이너를 실행하고 진행되는 변경 사항은 이 계층에 저장된다. 

이미지 레이어는 읽기 전용 계층으로 다른 컨테이너와 공유할 수 있는 레이어를 말한다. 

ex) 리눅스, ubuntu를 컨테이너로 사용한다 하면
1. 기본적으로 필요한 이미지 레이어를 내려받게 된다. 
   
여러 컨테이너로 가용한다 하면, 이미지레이어는 공유하지만, 각각 컨테이너 마다 컨테이너 레이어를 하나씩 붙여주며, 공유하지 않는 계층으로 이해하면 된다.

## 도커 명령어
도커를 사용하면서 컨테이너도 사용하고, 이미지, 볼륨, 네트워크 같은 것들이 있다. 여러 컴포넌트들이 존재하는데 제대로 사용하기 위해서는 명령어가 필요하다. 

```sh
docker {대상} {커맨드} {옵션} {인자}

커맨드 대상: container, image, volume, nerwork 
```

도커에서 사용할 수 있는 커맨드 리스트는 다음과 같다.
1. 'docker'입력
2. 'docker [command 대상]' --help 입력
3. 위와 같은 방법으로 커맨드 수준을 높이고 뒤에 --help 를 입력하면 됨

### docker container 이후에 작성하는 주요 커맨드는 아래와 같음

|커맨드|설명|주요옵션
|:---:|:---:|:---:|
|start|컨테이너 실행|-i|
|stop|컨테이너 정지||
|create|컨테이너 생성|--name, -e, -p, -v|
|run|이미지 내려받고 컨테이너를 생성 및 실행|--name, -e, -p, -v,-d,-i,-t|
|rm|컨테이너 삭제|-f, -v|
|exec|컨테이너에서 프로그램 실행|-i, -t|
|ls|컨테이너 목록 출력|-a|
|cp|컨테이너와 호스트간 파일 복사|-i|
|commit|컨테이너를 이미지로 변환|-i|

### docker image 이후에 작성하는 주요 커맨드는 다음과 같음
|커맨드|설명|주요옵션
|:---:|:---:|:---:|
|pull|이미지를 내려받음||
|rm|이미지 삭제||
|ls|가지고 있는 이미지 목록을 출력||
|build|이미지 생성|-t|

## 주로 사용하는 옵션에 대한 설명은 다음과 같음

| 옵션 | 설명|
|:---:|:---:|
|--name| 컨테이너 이름|
|-p|포트 번호 지정|
|-v | 볼륨 설정|
|-e|환경변수 설정|
|-d|백그라운드 실행|
|-i|컨테이너에 터미널 연결|
|-t|특수 키를 사용가능하게 설정|

# 3. 도커 컨테이너와 통신하기
도커 컨테이너는 기본적으로 독립적인 환경에서 실행되기 떄문에 컨테이너 밖에서 접근이 불가능함

컨테이너와 통신하기 위해서는 컨테이너를 가동시키면서 'p' 옵션을 사용하여 호스트의 포트와 컨테이너의 포트를 설정해야 함

`-p ${host_port}:${container_port}`
이 설정을 사용하기 위해서는 호스트(서버또는 PC)에서 사용중인 포트와 번호가 겹치지 않는지 확인이 필요함


도커 예제 코드
```sh
docker run --name test1 -d httpd

docker run --name test2 -d -p 8080:80 httpd
```
--nmae test1 : test1 이라는 이름으로 컨테이너를 생성합니다.
-d : 백그라운드로 동작합니다. 
-p 8080:80 > 호스트의 포트는 8080, 컨테이너의 포트는 80으로 세팅하여 네트워크를 설정합니다.

앞으 커맨드를 실행한 후에 docker 데스크 탑으로 컨테이너 상태를 확인 또는 아래 커맨드를 입력하여 상태를 확인
```sh
docker ps -a
docker container ls -a
```
`-a` 가 없으면 실행중인 컨테이너만 보여주게 됨 a라는 옵션을 붙여주면, 다양한 스테이터스를 가지고 있는 것들을 보여준다는 의미

컨테이너 실습을 마치면 아래 커맨드를 통해 실행을 중지하고 삭제하는 작업을 수행하는 것이 좋다.
```sh
docker stop test1
docker rm test1
```

# docker image download
```sh
docker pull httpd
```

# 4. 도커 컨테이너와 통신하기
```sh
docker run --name test1 -d httpd
docker run --name test1 -d -p 8080:80 httpd
```
바로 하면 오류가 남

삭제하려면 먼저 정지하고 해야 한다는 것  기억하기 


# 5. 도커파일 작성하기 
